CHIP P2S {
    IN indata[4], enable, load;
    OUT sout, complete;

    PARTS:
    // 将4位数据扩展到16位存储
    Register(in[0..3]=indata, in[4..15]=false, load=load, out=reg_out);

    // 2-bit计数器
    Counter(increment=enable, reset=load, out=count[0..1]);

    // 选择输出位
    Mux4Way(a=reg_out[0], b=reg_out[1], c=reg_out[2], d=reg_out[3], 
            sel=count, out=sout);

    // 完成信号
    And(a=count[0], b=count[1], out=both_high);
    And(a=enable, b=both_high, out=complete);
}
